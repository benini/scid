
trigger:
- master

jobs:
- job: ubuntu_latest
  pool:
    vmImage: 'ubuntu-latest'
  steps:
  - script: |
       sudo apt-get update &&
       sudo apt-get -y install tcl-dev tk-dev
    displayName: 'download tclt'
  - task: CMake@1
    inputs:
      workingDirectory: 'build'
      cmakeArgs: '-DGTEST=ON ..'
  - script: cmake --build build

- job: Windows_VS2019_UWP
  pool:
    vmImage: 'windows-latest'
  steps:
  - script: git submodule update --init vcpkg
    displayName: Checkout vcpkg submodule
  - script: .\vcpkg\bootstrap-vcpkg.bat
    displayName: Bootstrap vcpkg
  - script: .\vcpkg\vcpkg.exe install tcl zlib --triplet x64-uwp --vcpkg-root .\vcpkg
    displayName: vcpkg install dependencies
  - script: mkdir build.common
    displayName: Make Build Directory
  - task: CMake@1
    inputs:
      workingDirectory: 'build.common'
      cmakeArgs: '-A x64 -DCMAKE_TOOLCHAIN_FILE=../vcpkg/scripts/buildsystems/vcpkg.cmake'
  - task: MSBuild@1
    inputs:
      solution: 'build.common/ALL_BUILD.vcxproj'
      maximumCpuCount: true
      platform: 'x64'

